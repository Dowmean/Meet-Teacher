<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ตารางเวลาของอาจารย์</title>
</head>
<body>
    <h1>ตารางเวลาของอาจารย์</h1>
    <div id="schedules"></div>

    <script>
        // ดึง teacher_id จาก URL
        const teacherID = window.location.pathname.split('/').slice(-1)[0]; 

        // เรียก API เพื่อดึงข้อมูลตารางเวลา
        fetch(`/schedule/${teacherID}/api`)
    .then(response => response.json())
    .then(data => {
        const scheduleDiv = document.getElementById('schedules');
        const schedules = data.schedules;

        if (schedules.length > 0) {
            schedules.forEach(schedule => {
                const scheduleItem = document.createElement('div');

                // แสดงข้อมูล available_time ที่ได้รับจาก API เพื่อการตรวจสอบ
                console.log('Available time from API:', schedule.Availabletime);

                const time = new Date(schedule.Availabletime);  // แปลงเวลา
                const timeText = isNaN(time.getTime()) ? "เวลาไม่ถูกต้อง" : time.toLocaleString();
                const status = schedule.Is_booked ? 'ถูกจองแล้ว' : 'ยังว่าง';
                scheduleItem.textContent = `เวลา: ${timeText}, สถานะ: ${status}`;
                scheduleDiv.appendChild(scheduleItem);
            });
        } else {
            scheduleDiv.textContent = 'ไม่มีตารางเวลา';
        }
    })
    .catch(error => {
        console.error('Error fetching schedules:', error);
    });
    </script>
</body>
</html>
